    :root {
      --primary-color: #667eea;
      --secondary-color: #764ba2;
      --success-color: #28a745;
      --danger-color: #dc3545;
      --background-color: #f8f9fa;
      --text-color: #333;
      --text-light: #6c757d;
      --nav-height: 60px;
      --vh: 1vh;
    }
    html {
        height: 100%;
    }
    body {
        height: 100%;
        margin: 0;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        background-color: #e9ebee;
        display: flex;
        justify-content: center;
        align-items: center;
        overflow: hidden;
    }
    .app-container {
      width: 390px;
      height: 844px;
      max-height: 95vh;
      display: flex;
      flex-direction: column;
      background-color: var(--background-color);
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
      border-radius: 30px;
      border: none;
      position: relative;
      overflow: hidden;
      box-sizing: border-box;
    }
    main {
      flex: 1;
      overflow: hidden;
      position: relative;
      display: flex;
    }
    .page {
      width: 100%; height: 100%;
      display: none;
      flex-direction: column;
      overflow: hidden;
    }
    .page.active {
      display: flex;
    }
    .app-nav { height: var(--nav-height); width: 100%; background: #fff; border-top: 1px solid #e0e0e0; display: flex; justify-content: space-around; align-items: center; flex-shrink: 0; }
    .nav-item { display: flex; flex-direction: column; align-items: center; justify-content: center; color: var(--text-light); font-size: 12px; cursor: pointer; transition: color 0.2s; width: 100%; }
    .nav-item i { font-size: 22px; margin-bottom: 4px; }
    .nav-item.active { color: var(--primary-color); }
    #map-page {
      flex-direction: column;
    }
    #map-panel {
      flex: 6.5;
      position: relative;
      background: #e5e3df;
      width: 100%;
    }
    #list-panel {
      flex: 3.5;
      border-top: 1px solid #ddd;
      display: flex;
      flex-direction: column;
      background: white;
      overflow: hidden;
      width: 100%;
    }
    #map {
      width: 100%;
      height: 100%;
      position: absolute;
      top: 0;
      bottom: 0;
      left: 0;
      right: 0;
    }

    .search-area { padding: 15px; border-bottom: 1px solid #eee; background: white; flex-shrink: 0; position: relative; }
    .search-input { width: 100%; padding: 12px 40px 12px 15px; font-size: 16px; border-radius: 25px; border: 1px solid #ccc; box-sizing: border-box; }
    .clear-search-btn { position: absolute; top: 50%; right: 25px; transform: translateY(-50%); background: #ccc; border: none; width: 24px; height: 24px; border-radius: 50%; cursor: pointer; font-size: 14px; font-weight: bold; color: white; display: none; justify-content: center; align-items: center; }

    .filter-tags-container {
      display: flex;
      justify-content: flex-start;
      gap: 8px;
      padding: 0 15px 15px 15px;
      background: white;
      overflow-x: auto;
      -webkit-overflow-scrolling: touch;
      scrollbar-width: none;
    }
    .filter-tags-container::-webkit-scrollbar {
      display: none;
    }
    .filter-tag {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 6px 14px;
      border: 1px solid #ccc;
      border-radius: 20px;
      background-color: #f0f0f0;
      color: var(--text-color);
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      white-space: nowrap;
      transition: all 0.2s ease-in-out;
    }

    .filter-tag[data-filter-value="distance"]:hover {
      background-color: #e8eaf6;
    }
    .filter-tag[data-filter-value="distance"].active {
        background-color: var(--primary-color);
        color: white;
        border-color: var(--primary-color);
    }

    .filter-tag:not([data-filter-value="distance"]):hover {
        filter: brightness(0.95);
    }

    .filter-tag.active {
      transform: scale(1.05);
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
    }

    .filter-tag[data-filter-value="日式料理"] { background-color: #ffebee; border-color: #ffcdd2; color: #c62828; }
    .filter-tag[data-filter-value="火鍋"]     { background-color: #fff3e0; border-color: #ffe0b2; color: #ef6c00; }
    .filter-tag[data-filter-value="咖啡廳"]   { background-color: #efebe9; border-color: #d7ccc8; color: #5d4037; }
    .filter-tag[data-filter-value="義大利麵"] { background-color: #e8f5e9; border-color: #c8e6c9; color: #2e7d32; }
    .filter-tag[data-filter-value="早午餐"]   { background-color: #fffde7; border-color: #fff9c4; color: #f57f17; }
    .filter-tag[data-filter-value="小吃"]     { background-color: #eceff1; border-color: #cfd8dc; color: #37474f; }

    .filter-tag[data-filter-value="日式料理"].active { background-color: #e57373; border-color: #e57373; color: white; }
    .filter-tag[data-filter-value="火鍋"].active     { background-color: #ff9800; border-color: #fb8c00; color: white; }
    .filter-tag[data-filter-value="咖啡廳"].active   { background-color: #795548; border-color: #6d4c41; color: white; }
    .filter-tag[data-filter-value="義大利麵"].active { background-color: #66bb6a; border-color: #66bb6a; color: white; }
    .filter-tag[data-filter-value="早午餐"].active   { background-color: #ffee58; border-color: #fdd835; color: #333; }
    .filter-tag[data-filter-value="小吃"].active     { background-color: #78909c; border-color: #78909c; color: white; }

    .list-content { overflow-y: auto; flex-grow: 1; }
    .list-item { display: flex; align-items: flex-start; gap: 15px; padding: 15px; border-bottom: 1px solid #f0f0f0; cursor: pointer; transition: background-color 0.2s; }
    .list-item.is-selected { background-color: #e8eaf6; border-left: 4px solid var(--primary-color); padding-left: 11px; }
    .item-icon { font-size: 18px; color: var(--primary-color); margin-top: 3px; flex-shrink: 0; }
    .item-info { flex-grow: 1; min-width: 0; }
    .item-name { font-weight: 600; font-size: 16px; }
    .item-details, .item-address { font-size: 13px; color: var(--text-light); margin-top: 4px; }
    .item-address { white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .item-distance { font-weight: 500; font-size: 14px; color: var(--text-color); white-space: nowrap; text-align: right; }
    .open-status.open { color: #28a745; font-weight: bold; }
    .open-status.closed { color: #dc3545; font-weight: bold; }
    .list-status-text { text-align: center; color: #999; padding: 40px 20px; }
    .location-btn { position: absolute; bottom: 20px; right: 20px; background: #fff; color: var(--primary-color); border: none; width: 50px; height: 50px; border-radius: 25px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2); cursor: pointer; z-index: 10; font-size: 24px; display: flex; justify-content: center; align-items: center; }
    .gm-style-iw-d { overflow: auto !important; }
    .info-window-content { font-family: inherit; padding: 5px; max-width: 280px; }
    .info-window-content h4 { font-size: 16px; margin: 0 0 8px 0; font-weight: 600; display: flex; justify-content: space-between; align-items: center; }
    .info-window-content p { font-size: 14px; margin: 0 0 5px 0; color: #555; display: flex; align-items: center; }
    .info-window-content i { margin-right: 8px; color: var(--primary-color); width: 16px; text-align: center; flex-shrink: 0; }
    .favorite-btn { background: none; border: none; font-size: 22px; cursor: pointer; padding: 0 5px; color: #ddd; }
    .favorite-btn.is-favorite { color: var(--danger-color); }
    .page-header { padding: 15px 20px; background-color: #fff; border-bottom: 1px solid #eee; text-align: center; flex-shrink: 0; display: flex; justify-content: space-between; align-items: center; }
    .page-header h2 { margin: 0; font-size: 18px; color: var(--text-color); display: flex; align-items: center; justify-content: center; flex-grow: 1; }
    .page-header h2 i { margin-right: 10px; color: var(--primary-color); }
    .header-action { font-size: 16px; color: var(--primary-color); text-decoration: none; cursor: pointer; }
    .header-back-btn { font-size: 20px; color: var(--text-color); cursor: pointer; }
    .page-header .placeholder { width: 24px; }
    .page-content { flex-grow: 1; overflow-y: auto; padding: 20px; box-sizing: border-box; }
    .placeholder-text { text-align: center; color: var(--text-light); margin-top: 50px; padding: 20px; }
    .btn { display: block; width: 100%; padding: 15px; background-color: var(--success-color); color: white; border: none; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer; text-align: center; }
#random-picker-container { 
  display: flex; 
  flex-direction: column; 
  align-items: center; 
  justify-content: center; 
  height: 100%; 
  padding: 20px; 
  box-sizing: border-box; 
}

#picker-wheel {
  width: 280px;
  height: 280px;
  border: none;
  border-radius: 50%;
  position: relative;
  margin-bottom: 30px;
  transition: transform 4s cubic-bezier(0.25, 1, 0.5, 1);
  overflow: hidden;
}

.slice-text {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 90px;
  height: 60px;
  margin-left: -45px;
  margin-top: -30px;
  display: flex;
  align-items: center;
  justify-content: center;
  transform-origin: center center;
  color: white;
  font-weight: 600;
  font-size: 12px;
  text-shadow: 1px 1px 2px rgba(0,0,0,0.7);
  text-align: center;
  pointer-events: none;
}

/* 箭頭固定在輪盤正上方，朝下 */
#picker-arrow {
  position: absolute;
  top: 50%;              /* 輪盤中心 */
  left: 50%;             /* 輪盤中心 */
  transform: translate(580%,-350%) rotate(-90deg); /* 上移到輪盤上方並旋轉180度讓箭頭朝下 */
  width: 0;
  height: 0;
  border-left: 12px solid transparent;
  border-right: 12px solid transparent;
  border-bottom: 25px solid #333; /* 箭頭實體顏色 */
  z-index: 20;           /* 保證在最上層 */
}


#picker-result {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 80px;
  height: 80px;
  background-color: white;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 24px;
  font-weight: bold;
  color: var(--primary-color);
  text-align: center;
  z-index: 5;
  box-shadow: 0 0 10px rgba(0,0,0,0.2);
}



#random-status-text {
  min-height: 40px;
  font-size: 16px;
  font-weight: 500;
  color: var(--text-color);
}

#random-status-text.placeholder-text {
  font-size: 14px;
  font-weight: normal;
  color: var(--text-light);
}


    .form-group { margin-bottom: 20px; position: relative; } .form-group label { display: block; margin-bottom: 8px; font-weight: 500; color: var(--text-color); } .form-group input, .form-group textarea, .form-group select { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; font-size: 16px; } .form-group select { background-color: white; -webkit-appearance: none; } .form-group textarea { min-height: 120px; resize: vertical; } .rating-hearts { display: flex; gap: 10px; font-size: 30px; color: #ddd; cursor: pointer; } .rating-hearts .fa-heart:hover, .rating-hearts .fa-heart.active { color: #ff4d6d; }
    .photo-upload-container { background: #f0f0f0; border: 2px dashed #ccc; border-radius: 8px; padding: 20px; display: flex; flex-direction: column; align-items: center; gap: 15px; }
    .photo-upload-buttons { display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; }
    .btn-upload { background: #fff; color: var(--text-color); padding: 10px 20px; border-radius: 8px; cursor: pointer; border: 1px solid #ddd; display: inline-flex; align-items: center; }
    .btn-upload i { margin-right: 8px; }
    #photo-preview-container { display: flex; flex-wrap: wrap; gap: 10px; margin-top: 15px; justify-content: center; }
    .photo-preview-item { position: relative; width: 80px; height: 80px; border-radius: 8px; overflow: hidden; border: 1px solid #ddd; }
    .photo-preview-item img { width: 100%; height: 100%; object-fit: cover; }
    .delete-photo-btn { position: absolute; top: 3px; right: 3px; width: 20px; height: 20px; background-color: rgba(0,0,0,0.6); color: white; border: none; border-radius: 50%; cursor: pointer; display: flex; justify-content: center; align-items: center; font-size: 12px; font-weight: bold; line-height: 20px; }
    .profile-tabs { display: flex; gap: 10px; padding: 15px 20px; background: #fff; border-bottom: 1px solid #eee; overflow-x: auto; flex-shrink: 0; } .tab-btn { background: #f0f0f0; border: none; border-radius: 20px; padding: 8px 15px; font-size: 14px; cursor: pointer; white-space: nowrap; } .tab-btn.active { background: var(--primary-color); color: #fff; } .tab-content { display: none; } .tab-content.active { display: block; }
    .record-card, .post-card { position: relative; background: #fff; padding: 15px; border-radius: 8px; margin-bottom: 10px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); } .record-card .title, .post-card .title { font-weight: 600; margin-bottom: 5px; } .record-card .details, .post-card .details { font-size: 14px; color: var(--text-light); } .record-card .cost { font-weight: bold; color: var(--success-color); float: right; } .post-card .content { margin-top: 10px; font-size: 15px; line-height: 1.6; } .post-card .post-rating { margin-top: 10px; color: #ff4d6d; }
    .post-photos { display: flex; gap: 8px; margin-top: 10px; flex-wrap: wrap; }
    .post-photos img { width: 70px; height: 70px; object-fit: cover; border-radius: 6px; border: 1px solid #eee; }
    .card-actions { position: absolute; top: 10px; right: 10px; display: flex; gap: 8px; }
    .action-btn { background: none; border: 1px solid #ccc; border-radius: 5px; padding: 3px 8px; font-size: 12px; cursor: pointer; transition: all 0.2s; }
    .action-btn:disabled { opacity: 0.5; cursor: not-allowed; }
    .action-btn.btn-edit { color: var(--primary-color); border-color: var(--primary-color); }
    .action-btn.btn-edit:hover:not(:disabled) { background: var(--primary-color); color: white; }
    .action-btn.btn-delete { color: var(--danger-color); border-color: var(--danger-color); }
    .action-btn.btn-delete:hover:not(:disabled) { background: var(--danger-color); color: white; }
    .auth-form-container { width: 100%; max-width: 400px; margin: 0 auto; padding: 20px;}
    .auth-form-container h3 { text-align: center; margin-bottom: 20px; font-size: 20px; }
    .auth-form-container input { width: 100%; padding: 12px; border: 1px solid #ccc; border-radius: 8px; box-sizing: border-box; margin-bottom: 15px; font-size: 16px; }
    .btn-auth { width: 100%; padding: 12px; font-size: 16px; border-radius: 8px; border: none; cursor: pointer; margin-bottom: 10px; color: #fff; font-weight: bold; }
    .btn-auth.primary { background-color: var(--primary-color); }
    .btn-auth.secondary { background-color: #fff; color: #4285F4; border: 1px solid #ddd; display:flex; align-items:center; justify-content:center; gap: 10px;}
    .auth-separator { display: flex; align-items: center; text-align: center; color: #aaa; margin: 20px 0; }
    .auth-separator::before, .auth-separator::after { content: ''; flex: 1; border-bottom: 1px solid #ddd; }
    .auth-separator:not(:empty)::before { margin-right: .25em; }
    .auth-separator:not(:empty)::after { margin-left: .25em; }
    .auth-switch-link { text-align: center; margin-top: 15px; font-size: 14px; color: var(--primary-color); cursor: pointer; }
    #auth-error { color: #dc3545; margin-top: 15px; min-height: 20px; font-weight: 500; text-align: center; }
    .btn-scan-qr { position: absolute; top: 0; right: 0; background: var(--primary-color); color: white; border: none; border-radius: 0 8px 0 8px; padding: 5px 10px; font-size: 13px; cursor: pointer; }
    .btn-scan-qr i { margin-right: 5px; }
    #qr-scanner-modal { display: none; position: fixed; z-index: 1001; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.8); flex-direction: column; justify-content: center; align-items: center; }
    .qr-scanner-content { position: relative; background-color: #111; padding: 20px; border: 1px solid #888; width: 90%; max-width: 500px; border-radius: 10px; text-align: center; }
    #qr-scanner-video { width: 100%; border-radius: 8px; }
    #qr-status-text { color: white; font-size: 16px; margin-top: 15px; height: 40px; line-height: 1.4; }
    .qr-scanner-close-btn { position: absolute; top: -15px; right: -15px; color: white; background-color: #dc3545; border-radius: 50%; width: 30px; height: 30px; font-size: 20px; font-weight: bold; cursor: pointer; border: 2px solid white; display:flex; justify-content:center; align-items:center; }
    #scan-box { position: absolute; left: 50%; top: 50%; width: 60%; height: 50%; transform: translate(-50%, -50%); border: 3px solid rgba(255, 255, 255, 0.7); border-radius: 10px; box-shadow: 0 0 0 2000px rgba(0,0,0,0.5); }

    .challenge-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: #fff;
      padding: 15px;
      border-radius: 8px;
      margin-bottom: 10px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
      transition: background-color 0.2s;
    }
    .challenge-text {
      font-size: 16px;
      flex-grow: 1;
      margin-right: 15px;
    }
    .challenge-actions {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-shrink: 0;
    }
    .accounting-date-group { margin-bottom: 20px; }
    .accounting-date-header { font-size: 16px; font-weight: 600; padding-bottom: 8px; border-bottom: 1px solid #eee; margin-bottom: 10px; }
    .accounting-meal-header { font-size: 14px; font-weight: 500; color: var(--text-light); margin: 15px 0 5px 0; }

    @media (min-width: 1200px) {
      .app-container {
        width: 100%;
        max-width: 1280px;
        height: 90vh;
        max-height: 800px;
        border-radius: 16px;
        border: none;
      }
      #map-page {
        flex-direction: row;
      }
      #map-panel {
        width: 60%;
        height: 100%;
        flex: 6;
      }
      #list-panel {
        width: 40%;
        height: 100%;
        flex: 4;
        border-top: none;
        border-left: 1px solid #ddd;
      }
      #add-review-page .page-content,
      #challenge-page .page-content,
      #profile-page .page-content,
      #login-page .page-content,
      #register-page .page-content {
        max-width: 700px;
        width: 100%;
        margin: 0 auto;
      }
    }